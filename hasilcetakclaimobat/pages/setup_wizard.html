<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup Database - Berkas Digital Apotek</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .setup-card {
            max-width: 800px;
            margin: 50px auto;
        }
        .step-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #0d6efd;
            margin-bottom: 20px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="setup-card">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0">
                        <i class="bi bi-gear-fill"></i> Setup Database Berkas Digital Apotek
                    </h3>
                </div>
                <div class="card-body">
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle-fill"></i> <strong>Pilih Cara Setup:</strong>
                        Pilih salah satu cara di bawah untuk membuat tabel database.
                    </div>

                    <!-- CARA 1: AUTO SETUP -->
                    <div class="step-box">
                        <h5><i class="bi bi-1-circle-fill text-primary"></i> Auto Setup (Paling Mudah)</h5>
                        <p>Klik tombol di bawah untuk otomatis membuat tabel:</p>
                        <a href="create_table_berkas.php" class="btn btn-primary btn-lg" target="_blank">
                            <i class="bi bi-play-circle"></i> Jalankan Auto Setup
                        </a>
                    </div>

                    <!-- CARA 2: MANUAL VIA PHPMYADMIN -->
                    <div class="step-box">
                        <h5><i class="bi bi-2-circle-fill text-success"></i> Manual via phpMyAdmin</h5>
                        <ol>
                            <li>Buka <a href="http://localhost/phpmyadmin" target="_blank">phpMyAdmin</a></li>
                            <li>Pilih database <code>sik</code></li>
                            <li>Klik tab <strong>SQL</strong></li>
                            <li>Copy SQL di bawah dan paste:</li>
                        </ol>
                        <div class="code-block">
<pre style="margin:0; color:#f8f8f2;">CREATE TABLE IF NOT EXISTS `berkas_digital_apotek` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `no_rkm_medis` VARCHAR(15) NOT NULL,
  `kode_berkas` VARCHAR(20) NOT NULL,
  `nama_berkas` VARCHAR(100) NOT NULL,
  `lokasi_file` TEXT NOT NULL,
  `tgl_upload` DATETIME DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `unique_berkas` (`no_rkm_medis`, `kode_berkas`),
  KEY `no_rkm_medis` (`no_rkm_medis`),
  KEY `kode_berkas` (`kode_berkas`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;</pre>
                        </div>
                        <button class="btn btn-secondary btn-sm mt-2" onclick="copySQL()">
                            <i class="bi bi-clipboard"></i> Copy SQL
                        </button>
                    </div>

                    <!-- CARA 3: FILE SQL -->
                    <div class="step-box">
                        <h5><i class="bi bi-3-circle-fill text-warning"></i> Import File SQL</h5>
                        <p>Download dan import file SQL:</p>
                        <a href="setup_database.sql" class="btn btn-warning" download>
                            <i class="bi bi-download"></i> Download setup_database.sql
                        </a>
                        <p class="mt-2 mb-0 text-muted">
                            <small>Kemudian import via phpMyAdmin ‚Üí Import ‚Üí Choose File</small>
                        </p>
                    </div>

                    <!-- VERIFIKASI -->
                    <div class="alert alert-success mt-4">
                        <h5><i class="bi bi-check-circle-fill"></i> Setelah Setup</h5>
                        <p class="mb-2">Pastikan setup berhasil dengan menjalankan query:</p>
                        <code>SHOW TABLES LIKE 'berkas_digital_apotek';</code>
                    </div>

                    <!-- NEXT STEPS -->
                    <div class="card bg-light mt-4">
                        <div class="card-body">
                            <h5><i class="bi bi-list-check"></i> Langkah Selanjutnya</h5>
                            <ol class="mb-0">
                                <li>‚úÖ Setup database (sedang dilakukan)</li>
                                <li>üìÅ Buat folder: <a href="create_folders.php" target="_blank">create_folders.php</a></li>
                                <li>üìÑ Baca dokumentasi: <a href="dokumentasi_upload.html" target="_blank">dokumentasi_upload.html</a></li>
                                <li>üöÄ Mulai upload berkas di halaman preview</li>
                            </ol>
                        </div>
                    </div>

                </div>
                <div class="card-footer text-center">
                    <a href="dokumentasi_upload.html" class="btn btn-info">
                        <i class="bi bi-book"></i> Dokumentasi Lengkap
                    </a>
                    <a href="previewriwayat.php?no_rkm_medis=" class="btn btn-primary">
                        <i class="bi bi-arrow-left"></i> Ke Halaman Preview
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        function copySQL() {
            const sql = `CREATE TABLE IF NOT EXISTS \`berkas_digital_apotek\` (
  \`id\` INT(11) NOT NULL AUTO_INCREMENT,
  \`no_rkm_medis\` VARCHAR(15) NOT NULL,
  \`kode_berkas\` VARCHAR(20) NOT NULL,
  \`nama_berkas\` VARCHAR(100) NOT NULL,
  \`lokasi_file\` TEXT NOT NULL,
  \`tgl_upload\` DATETIME DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (\`id\`),
  UNIQUE KEY \`unique_berkas\` (\`no_rkm_medis\`, \`kode_berkas\`),
  KEY \`no_rkm_medis\` (\`no_rkm_medis\`),
  KEY \`kode_berkas\` (\`kode_berkas\`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;`;

            navigator.clipboard.writeText(sql).then(() => {
                alert('SQL berhasil di-copy! Paste di phpMyAdmin.');
            });
        }
    </script>
</body>
</html>
